xmin = -Inf, xmax = Inf, ymin = -Inf, ymax = Inf)
x
x$core$fg_params$fontfamily='STHeiti'
ggplot(test1,aes(x=mpg,y=qsec))+geom_blank()+
theme_bw() +
theme(line = element_blank(),
text = element_blank(),
panel.grid=element_blank(),
panel.border=element_blank()) +
annotation_custom(grob = tableGrob(coln,theme = x),
xmin = -Inf, xmax = Inf, ymin = -Inf, ymax = Inf)
help("element_blank")
help("theme")
help("unit")
ggplot(test1,aes(x=mpg,y=qsec))+geom_blank()+
theme_bw() +
theme(line = element_blank(),
text = element_blank(),
panel.grid=element_blank(),
panel.border=element_blank(),
plot.margin = unit(c(1,1,1,1), "cm")) +
annotation_custom(grob = tableGrob(coln,theme = x),
xmin = -Inf, xmax = Inf, ymin = -Inf, ymax = Inf)
ggplot(test1,aes(x=mpg,y=qsec))+geom_blank()+
theme_bw() +
theme(line = element_blank(),
text = element_blank(),
panel.grid=element_blank(),
panel.border=element_blank(),
plot.margin = unit(c(0,0,0,0), "cm")) +
annotation_custom(grob = tableGrob(coln,theme = x),
xmin = -Inf, xmax = Inf, ymin = -Inf, ymax = Inf)
ggplot(test1,aes(x=mpg,y=qsec))+geom_blank()+
theme_bw() +
theme(line = element_blank(),
text = element_blank(),
panel.grid=element_blank(),
panel.border=element_blank(),
plot.margin = unit(c(0,0,0,0), "cm")) +
annotation_custom(grob = tableGrob(coln,theme = x,widths=unit(1,"null"), heights=unit(1/(nrow(d)),"npc")),
xmin = -Inf, xmax = Inf, ymin = -Inf, ymax = Inf)
ggplot(test1,aes(x=mpg,y=qsec))+geom_blank()+
theme_bw() +
theme(line = element_blank(),
text = element_blank(),
panel.grid=element_blank(),
panel.border=element_blank(),
plot.margin = unit(c(0,0,0,0), "cm")) +
annotation_custom(grob = tableGrob(coln,theme = x,widths=unit(1,"null"), heights=unit(1,"null"),"npc"),
xmin = -Inf, xmax = Inf, ymin = -Inf, ymax = Inf)
x$core$padding=c('10mm','10mm')
ggplot(test1,aes(x=mpg,y=qsec))+geom_blank()+
theme_bw() +
theme(line = element_blank(),
text = element_blank(),
panel.grid=element_blank(),
panel.border=element_blank(),
plot.margin = unit(c(0,0,0,0), "cm")) +
annotation_custom(grob = tableGrob(coln,theme = x,
xmin = -Inf, xmax = Inf, ymin = -Inf, ymax = Inf)
ggplot(test1,aes(x=mpg,y=qsec))+geom_blank()+
theme_bw() +
theme(line = element_blank(),
text = element_blank(),
panel.grid=element_blank(),
panel.border=element_blank(),
plot.margin = unit(c(0,0,0,0), "cm")) +
annotation_custom(grob = tableGrob(coln,theme = x),
xmin = -Inf, xmax = Inf, ymin = -Inf, ymax = Inf)
x$core$padding=c('4mm','4mm')
ggplot(test1,aes(x=mpg,y=qsec))+geom_blank()+
theme_bw() +
theme(line = element_blank(),
text = element_blank(),
panel.grid=element_blank(),
panel.border=element_blank(),
plot.margin = unit(c(0,0,0,0), "cm")) +
annotation_custom(grob = tableGrob(coln,theme = x),
xmin = -Inf, xmax = Inf, ymin = -Inf, ymax = Inf)
ggplot(test1,aes(x=mpg,y=qsec))+geom_blank()+
theme_bw() +
theme(line = element_blank(),
text = element_blank(),
panel.grid=element_blank(),
panel.border=element_blank()) +
annotation_custom(grob = tableGrob(coln,theme = x),
xmin = -Inf, xmax = Inf, ymin = -Inf, ymax = Inf)
x=ttheme_default()
x$colhead$fg_params$col='white'
x$core$bg_params$fill="#FCE3C6"
x$colhead$bg_params$fill='orange'
x$rowhead$fg_params$col='white'
x$core$fg_params$fontfamily='STHeiti'
ggplot(test1,aes(x=mpg,y=qsec))+geom_blank()+
theme_bw() +
theme(line = element_blank(),
text = element_blank(),
panel.grid=element_blank(),
panel.border=element_blank()) +
annotation_custom(grob = tableGrob(coln,theme = x),
xmin = -Inf, xmax = Inf, ymin = -Inf, ymax = Inf)
x$core$padding
class(x$core$padding)
help(unit)
x$core$padding=unit(c(4,4),'mm')
class(x$core$padding)
x$core$padding
x$core$padding=unit(c(10,10),'mm')
ggplot(test1,aes(x=mpg,y=qsec))+geom_blank()+
theme_bw() +
theme(line = element_blank(),
text = element_blank(),
panel.grid=element_blank(),
panel.border=element_blank()) +
annotation_custom(grob = tableGrob(coln,theme = x),
xmin = -Inf, xmax = Inf, ymin = -Inf, ymax = Inf)
x$core$padding=unit(c(20,20),'mm')
ggplot(test1,aes(x=mpg,y=qsec))+geom_blank()+
theme_bw() +
theme(line = element_blank(),
text = element_blank(),
panel.grid=element_blank(),
panel.border=element_blank()) +
annotation_custom(grob = tableGrob(coln,theme = x),
xmin = -Inf, xmax = Inf, ymin = -Inf, ymax = Inf)
x$core$padding=unit(c(15,15),'mm')
ggplot(test1,aes(x=mpg,y=qsec))+geom_blank()+
theme_bw() +
theme(line = element_blank(),
text = element_blank(),
panel.grid=element_blank(),
panel.border=element_blank()) +
annotation_custom(grob = tableGrob(coln,theme = x),
xmin = -Inf, xmax = Inf, ymin = -Inf, ymax = Inf)
x$core$padding=unit(c(10,10),'mm')
ggplot(test1,aes(x=mpg,y=qsec))+geom_blank()+
theme_bw() +
theme(line = element_blank(),
text = element_blank(),
panel.grid=element_blank(),
panel.border=element_blank()) +
annotation_custom(grob = tableGrob(coln,theme = x),
xmin = -Inf, xmax = Inf, ymin = -Inf, ymax = Inf)
x$rowhead$padding=unit(c(2,2),'mm')
x$core$fg_params$fontsize=18
x$rowhead$padding=unit(c(2,2),'mm')
ggplot(test1,aes(x=mpg,y=qsec))+geom_blank()+
theme_bw() +
theme(line = element_blank(),
text = element_blank(),
panel.grid=element_blank(),
panel.border=element_blank()) +
annotation_custom(grob = tableGrob(coln,theme = x),
xmin = -Inf, xmax = Inf, ymin = -Inf, ymax = Inf)
x$core$fg_params$fontsize=16
ggplot(test1,aes(x=mpg,y=qsec))+geom_blank()+
theme_bw() +
theme(line = element_blank(),
text = element_blank(),
panel.grid=element_blank(),
panel.border=element_blank()) +
annotation_custom(grob = tableGrob(coln,theme = x),
xmin = -Inf, xmax = Inf, ymin = -Inf, ymax = Inf)
x$core$fg_params$fontsize=14
ggplot(test1,aes(x=mpg,y=qsec))+geom_blank()+
theme_bw() +
theme(line = element_blank(),
text = element_blank(),
panel.grid=element_blank(),
panel.border=element_blank()) +
annotation_custom(grob = tableGrob(coln,theme = x),
xmin = -Inf, xmax = Inf, ymin = -Inf, ymax = Inf)
x$colhead$fg_params$col='orange'
ggplot(test1,aes(x=mpg,y=qsec))+geom_blank()+
theme_bw() +
theme(line = element_blank(),
text = element_blank(),
panel.grid=element_blank(),
panel.border=element_blank()) +
annotation_custom(grob = tableGrob(coln,theme = x),
xmin = -Inf, xmax = Inf, ymin = -Inf, ymax = Inf)
x$core$fg_params$fontface=2L
ggplot(test1,aes(x=mpg,y=qsec))+geom_blank()+
theme_bw() +
theme(line = element_blank(),
text = element_blank(),
panel.grid=element_blank(),
panel.border=element_blank()) +
annotation_custom(grob = tableGrob(coln,theme = x),
xmin = -Inf, xmax = Inf, ymin = -Inf, ymax = Inf)
x$core$fg_params$fontface=3L
ggplot(test1,aes(x=mpg,y=qsec))+geom_blank()+
theme_bw() +
theme(line = element_blank(),
text = element_blank(),
panel.grid=element_blank(),
panel.border=element_blank()) +
annotation_custom(grob = tableGrob(coln,theme = x),
xmin = -Inf, xmax = Inf, ymin = -Inf, ymax = Inf)
x
ftable(Titanic, row.vars = 1:3)
Titanic
ubike1<- select(ubike,hour,sarea,sna,tot,avg.sbi) %>%
filter(sarea=='永和區' & hour==7) %>%
mutate(rate=avg.sbi/tot) %>%
group_by(sna)
ubike1
ubike1<- select(ubike,hour,sarea,sna,tot,avg.sbi) %>%
filter(sarea=='中和區' & hour==7) %>%
mutate(rate=avg.sbi/tot) %>%
group_by(sna)
ubike1
head(ubike1)
ubike1<- select(ubike,hour,sarea,sna,tot,avg.sbi) %>%
filter(sarea=='中和區' & hour==7) %>%
mutate(rate=avg.sbi/tot) %>%
group_by(sna) %>%
summarise(avg_rate=mean(avg.sbi))
ubike1
select(ubike,sarea,sna) %>% filter(sarea=="板橋區") %>% distinct(sna)
ubike3<- select(ubike,hour,sarea,sna,max.anemo,lng,lat) %>%
filter(sarea=='中和區',hour==15) %>%
group_by(sna) %>%
summarise(avg_anemo=mean(max.anemo))
ubike3
?full_join
bind_cols(ubike1,ubike3)
left_join(ubike1,ubike3)
WP.melt=as.data.frame(WorldPhones)
WP.melt$year <- rownames(WP.df)
WP.melt=melt(WP.melt,id='year')
WP.melt=as.data.frame(WorldPhones)
WP.melt$year <- rownames(WP.melt)
WP.melt=melt(WP.melt,id='year')
WP.melt
help(cast)
help(dcast)
WP.cast=dcast(WP.melt,year~variable,value.var=value)
WP.cast=dcast(WP.melt,year~variable,value.var="value")
WP.cast
ubike4=filter(ubike, 場站區域=='中和區',時間==8) %>%
mutate(is.rain=降雨量>1) %>%
mutate(is.rain=factor(is.rain, levels=c(FALSE, TRUE),
labels = c("晴天","雨天"))) %>%
select(日期,  平均空位數, 場站名稱, is.rain,總停車格) %>%
group_by(場站名稱,  is.rain) %>%
summarise(use_rate=mean(平均空位數/總停車格))
ubike4=filter(ubike, sarea=='中和區',hour==8) %>%
mutate(is.rain=rainfall>1) %>%
mutate(is.rain=factor(is.rain, levels=c(FALSE, TRUE),
labels = c("晴天","雨天"))) %>%
select(date,  avg.bemp, sna, is.rain,tot) %>%
group_by(場站名稱,  is.rain) %>%
summarise(use_rate=mean(avg.bemp/tot))
ubike4=filter(ubike, sarea=='中和區',hour==8) %>%
mutate(is.rain=rainfall>1) %>%
mutate(is.rain=factor(is.rain, levels=c(FALSE, TRUE),
labels = c("晴天","雨天"))) %>%
select(date,  avg.bemp, sna, is.rain,tot) %>%
group_by(sna,  is.rain) %>%
summarise(use_rate=mean(avg.bemp/tot))
ubike4
ubike4=filter(ubike, sarea=='中和區',hour==8) %>%
mutate(is.rain=rainfall>1) %>%
mutate(is.rain=factor(is.rain, levels=c(FALSE, TRUE),
labels = c("晴天","雨天"))) %>%
select(date,  avg.bemp, sna, is.rain,tot) %>%
group_by(sna,  is.rain) %>%
summarise(use_rate=mean(avg.bemp/tot)) %>%
dcast(sna~is.rain,value.var="use_rate")
ubike4
library(ggmap)
geocode('台灣大學')
geocode(iconv("台灣大學", to = "UTF-8"))
help("geocode")
geocode(iconv("台灣大學", to = "UTF-8"),source = "google")
geocode("台灣大學",source = "google")
geocode("陽明大學",source = "google")
ftable(ubike4)
install.packages("GGally")
install.packages("geosphere")
install.packages("ggdendro")
getwd()
setwd("/Users/benjamin/")
library(slidify)
library(slidifyLibraries)
setwd("/Be")
setwd("Ben/")
ubike1 <- filter(ubike, sno==1) %>%
mutate(sbi.range=max.sbi-min.sbi) %>%
mutate(is.rushhours=cut(hour, breaks=c(0, 8, 10, 17, 20, 24),
labels = c(0,1,0,1,0), right=FALSE)) %>%
mutate(is.weekday=ifelse(strftime(date, "%u") < 6, 1, 0))
ubike <- fread("/Users/benjamin/test/data/ubikeweatherutf8.csv",
showProgress = interactive(), data.table = FALSE)
ubike1 <- filter(ubike, sno==1) %>%
mutate(sbi.range=max.sbi-min.sbi) %>%
mutate(is.rushhours=cut(hour, breaks=c(0, 8, 10, 17, 20, 24),
labels = c(0,1,0,1,0), right=FALSE)) %>%
mutate(is.weekday=ifelse(strftime(date, "%u") < 6, 1, 0))
ubike <- fread("/Users/benjamin/test/data/ubikeweatherutf8.csv",
data.table = FALSE,
colClasses=c("factor","integer","integer","factor","factor","numeric","numeric","integer","numeric","integer","integer","numeric","numeric","integer","integer","numeric","numeric","numeric","numeric","numeric","numeric"))
ubike1 <- filter(ubike, sno==1) %>%
mutate(sbi.range=max.sbi-min.sbi) %>%
mutate(is.rushhours=cut(hour, breaks=c(0, 8, 10, 17, 20, 24),
labels = c(0,1,0,1,0), right=FALSE)) %>%
mutate(is.weekday=ifelse(strftime(date, "%u") < 6, 1, 0))
ubike1 <- filter(ubike, sno==1) %>%
mutate(sbi.range=max.sbi-min.sbi) %>%
mutate(is.rushhours=cut(hour, breaks=c(0, 8, 10, 17, 20, 24),
labels = c(0,1,0,1,0), right=FALSE))
cut(hour, breaks=c(0, 8, 10, 17, 20, 24),
labels = c(0,1,0,1,0), right=FALSE)
cut(ubike$hour, breaks=c(0, 8, 10, 17, 20, 24),
labels = c(0,1,0,1,0), right=FALSE)
ubike1 <- filter(ubike, sno==1) %>%
mutate(sbi.range=max.sbi-min.sbi) %>%
mutate(is.rushhours=cut(hour, breaks=c(0, 8, 10, 17, 20, 24),
labels = c(0,1,0,1,0), right=FALSE))
head(ubike1)
cut(hour, breaks=c(0, 8, 10, 17, 20, 24))
cut(ubike$hour, breaks=c(0, 8, 10, 17, 20, 24))
help(cut)
ubike3<- filter(ubike,sarea=='永和區', date=="2014-12-31",hour==15)
# 讀取永和區的地圖，以永和區的第一筆資料的經緯度為中心
m<-get_map(location=c(lon=ubike3$lng[1], lat=ubike3$lat[1]),             maptype = "roadmap", zoom = 14)
# ggmap(m)畫出地圖，並以此為底圖，在地圖上以geom_point畫出圓圈
# aes(x=lng,y=lat,size=max.anemo)，X和Y為經緯度，size則是以max.anemo為依據
# geom_text將站名顯示於地圖上，vjust與hjust分別控制垂直與水平方向的微調
# facebold: 字型樣式，1代表標準，2代表粗體，3代表斜體，4代表斜粗體
# legend.position="none"將原本會出現的legend隱藏
ggmap(m)+
geom_point(data=ubike3,aes(x=lng,y=lat,size=max.anemo),color='blue',alpha=0.75)+
scale_size(range = c(5,20))+
geom_text(data=ubike3,aes(x=lng,y=lat,label=sna),color='red',vjust=-1,hjust=-0.17,fontface=2)+
theme(text=element_text(size=20),legend.position="none")
ubike3<- filter(ubike,sarea=='中和區', date=="2014-12-31",hour==15)
# 讀取永和區的地圖，以永和區的第一筆資料的經緯度為中心
m<-get_map(location=c(lon=ubike3$lng[1], lat=ubike3$lat[1]),             maptype = "roadmap", zoom = 14)
# ggmap(m)畫出地圖，並以此為底圖，在地圖上以geom_point畫出圓圈
# aes(x=lng,y=lat,size=max.anemo)，X和Y為經緯度，size則是以max.anemo為依據
# geom_text將站名顯示於地圖上，vjust與hjust分別控制垂直與水平方向的微調
# facebold: 字型樣式，1代表標準，2代表粗體，3代表斜體，4代表斜粗體
# legend.position="none"將原本會出現的legend隱藏
ggmap(m)+
geom_point(data=ubike3,aes(x=lng,y=lat,size=max.anemo),color='blue',alpha=0.75)+
scale_size(range = c(5,20))+
geom_text(data=ubike3,aes(x=lng,y=lat,label=sna),color='red',vjust=-1,hjust=-0.17,fontface=2)+
theme(text=element_text(size=20),legend.position="none")
ubike3
ubike3<- filter(ubike,sarea=='中和區', date=="2014-12-30",hour==15)
ubike3
ggmap(m)+
geom_point(data=ubike3,aes(x=lng,y=lat,size=max.anemo),color='royalblue1',alpha=0.75)+
scale_size(range = c(5,20))+
geom_text(data=ubike3,aes(x=lng,y=lat,label=sna),color='red',vjust=-1,hjust=-0.17,fontface=2)+
theme(text=element_text(size=20),legend.position="none")
ubike3<- filter(ubike,sarea=='中和區', date=="2015-03-02",hour==15)
ubike3
?weekdays
weekdays('2015-03-02')
weekdays(Sys.time())
weekdays(Sys.time())
class(ubike3$date)
as.Date(ubike3$date)
weekdays(as.Date(ubike3$date))
ubike3<- filter(ubike,sarea=='中和區', hour==15) %>%
mutate(weekday=weekdays(as.Date(date))) %>%
filter(weekday=="周六",weekday=="周日")
head(ubike3)
help("filter")
ubike3<- filter(ubike,sarea=='中和區', hour==15) %>%
mutate(weekday=weekdays(as.Date(date))) %>%
filter(weekday=="周六"|weekday=="周日")
head(ubike3)
ubike3<- filter(ubike,sarea=='中和區', hour==15) %>%
mutate(weekday=weekdays(as.Date(date))) %>%
filter(weekday=="周六"|weekday=="周日") %>%
group_by(sna) %>%
summarise(avg_wind=mean(max.anemo),avg_sbi=mean(avg.sbi))
ubike3
ubike3<- filter(ubike,sarea=='中和區', hour==15) %>%
mutate(weekday=weekdays(as.Date(date))) %>%
filter(weekday=="周六"|weekday=="周日") %>%
group_by(sna) %>%
summarise(avg_wind=mean(max.anemo),avg_sbi=mean(avg.sbi),avg_hu=mean(humidity))
ubike3<- filter(ubike,sarea=='中和區', hour==15) %>%
mutate(weekday=weekdays(as.Date(date))) %>%
filter(weekday=="周六"|weekday=="周日") %>%
group_by(sna) %>%
summarise(avg_wind=mean(max.anemo),avg_sbi=mean(avg.sbi),
avg_hu=mean(humidity),lng=unique(lng),lat=unique(lat))
ubike3
m<-get_map(location=c(lon=ubike3$lng[1], lat=ubike3$lat[1]),             maptype = "roadmap", zoom = 14)
ggmap(m)+
geom_point(data=ubike3,aes(x=lng,y=lat,size=max.anemo),color='royalblue1',alpha=0.75)+
scale_size(range = c(5,20))+
geom_text(data=ubike3,aes(x=lng,y=lat,label=sna),color='red',vjust=-1,hjust=-0.17,fontface=2)+
theme(text=element_text(size=20),legend.position="none")
ggmap(m)+
geom_point(data=ubike3,aes(x=lng,y=lat,size=avg_wind),color='royalblue1',alpha=0.75)+
scale_size(range = c(5,20))+
geom_text(data=ubike3,aes(x=lng,y=lat,label=sna),color='red',vjust=-1,hjust=-0.17,fontface=2)+
theme(text=element_text(size=20),legend.position="none")
ggmap(m)+
geom_point(data=ubike3,aes(x=lng,y=lat,size=avg_wind,alpha=avg_hu,color=avg_sbi))+
scale_size(range = c(5,20))+
geom_text(data=ubike3,aes(x=lng,y=lat,label=sna),color='red',vjust=-1,hjust=-0.17,fontface=2)+
theme(text=element_text(size=20),legend.position="none")
ggmap(m)+
geom_point(data=ubike3,aes(x=lng,y=lat,size=avg_wind,alpha=avg_hu,color=avg_sbi))+
scale_size(range = c(5,20))+
scale_alpha(range = c(0.5,1))+
geom_text(data=ubike3,aes(x=lng,y=lat,label=sna),color='red',vjust=-1,hjust=-0.17,fontface=2)+
theme(text=element_text(size=20),legend.position="none")
ggmap(m)+
geom_point(data=ubike3,aes(x=lng,y=lat,size=avg_wind,alpha=avg_hu,color=avg_sbi))+
scale_size(range = c(5,20))+
scale_alpha(range = c(0.5,1))+
geom_text(data=ubike3,aes(x=lng,y=lat,label=sna),color='red',vjust=-1,hjust=-0.17,fontface=2)+
theme(text=element_text(size=20,family = "STKaiTi"),legend.position="none")
ggmap(m)+
geom_point(data=ubike3,aes(x=lng,y=lat,size=avg_wind,alpha=avg_hu,color=avg_sbi))+
scale_size(range = c(5,20))+
scale_alpha(range = c(0.5,1))+
geom_text(data=ubike3,aes(x=lng,y=lat,label=sna),color='red',vjust=-1,hjust=-0.17,fontface=2)+
theme(text=element_text(size=20,family = "STHeiti"),legend.position="none")
ggmap(m)+
geom_point(data=ubike3,aes(x=lng,y=lat,size=avg_wind,alpha=avg_hu,color=avg_sbi))+
scale_size(range = c(5,20))+
scale_alpha(range = c(0.5,1))+
geom_text(data=ubike3,aes(x=lng,y=lat,label=sna),color='red',vjust=-1,hjust=-0.17,fontface=2,family = "STHeiti")+
theme(text=element_text(size=20),legend.position="none")
ggmap(m)+
geom_point(data=ubike3,aes(x=lng,y=lat,size=avg_wind,alpha=avg_hu,color=avg_sbi))+
scale_size(range = c(5,20))+
scale_alpha(range = c(0.5,1))+
geom_text(data=ubike3,aes(x=lng,y=lat,label=sna),color='red',vjust=-1,hjust=-0.17,fontface=2,family = "STHeiti")+
theme(text=element_text(size=20))
ggmap(m)+
geom_point(data=ubike3,aes(x=lng,y=lat,size=avg_wind,alpha=avg_hu,color=avg_sbi))+
scale_size(range = c(5,20))+
scale_alpha(range = c(0.5,1))+
geom_text(data=ubike3,aes(x=lng,y=lat,label=sna),color='red',vjust=c(-1,1,-1,1),hjust=-0.17,fontface=2,family = "STHeiti")+
theme(text=element_text(size=20))
ggmap(m)+
geom_point(data=ubike3,aes(x=lng,y=lat,size=avg_wind,alpha=avg_hu,color=avg_sbi))+
scale_size(range = c(5,20))+
scale_alpha(range = c(0.5,1))+
geom_text(data=ubike3,aes(x=lng,y=lat,label=sna),color='red',vjust=c(1,-2,1,1),hjust=-0.17,fontface=2,family = "STHeiti")+
theme(text=element_text(size=20))
ggmap(m)+
geom_point(data=ubike3,aes(x=lng,y=lat,size=avg_wind,alpha=avg_hu,color=avg_sbi))+
scale_size(range = c(5,20))+
scale_alpha(range = c(0.5,1))+
geom_text(data=ubike3,aes(x=lng,y=lat,label=sna),color='red',vjust=c(1,3,4,-1),hjust=-0.17,fontface=2,family = "STHeiti")+
theme(text=element_text(size=20))
ubike3
ggmap(m)+
geom_point(data=ubike3,aes(x=lng,y=lat,size=avg_wind,alpha=avg_hu,color=avg_sbi))+
scale_size(range = c(5,20))+
scale_alpha(range = c(0.5,1))+
geom_text(data=ubike3,aes(x=lng,y=lat,label=sna),color='red',vjust=c(-1,0,2,0),hjust=0,fontface=2,family = "STHeiti")+
theme(text=element_text(size=20))
ggmap(m)+
geom_point(data=ubike3,aes(x=lng,y=lat,size=avg_wind,alpha=avg_hu,color=avg_sbi))+
scale_size(range = c(5,20))+
scale_alpha(range = c(0.5,1))+
geom_text(data=ubike3,aes(x=lng,y=lat,label=sna),color='red',vjust=c(-1,1,2,0),hjust=0,fontface=2,family = "STHeiti")+
theme(text=element_text(size=20))
ggmap(m)+
geom_point(data=ubike3,aes(x=lng,y=lat,size=avg_wind,alpha=avg_hu,color=avg_sbi))+
scale_size(range = c(5,20))+
scale_alpha(range = c(0.5,1))+
geom_text(data=ubike3,aes(x=lng,y=lat,label=sna),color='red',vjust=c(-1,1,1.5,0),hjust=0,fontface=2,family = "STHeiti")+
theme(text=element_text(size=20))
ggmap(m)+
geom_point(data=ubike3,aes(x=lng,y=lat,size=avg_wind,alpha=avg_hu,color=avg_sbi))+
scale_size(range = c(5,20))+
scale_alpha(range = c(0.5,1))+
geom_text(data=ubike3,aes(x=lng,y=lat,label=sna),color='red',vjust=c(-1,1,1,0),hjust=0,fontface=2,family = "STHeiti")+
theme(text=element_text(size=20))
?scale_color_continuous
ggmap(m)+
geom_point(data=ubike3,aes(x=lng,y=lat,size=avg_wind,alpha=avg_hu,color=avg_sbi))+
scale_size(range = c(5,20))+
scale_alpha(range = c(0.5,1))+
geom_text(data=ubike3,aes(x=lng,y=lat,label=sna),color='red',vjust=c(-1,1,1,0),hjust=0,fontface=2,family = "STHeiti")+
theme(text=element_text(size=20))+scale_color_gradient(low="orange",hight="yellow")
ggmap(m)+
geom_point(data=ubike3,aes(x=lng,y=lat,size=avg_wind,alpha=avg_hu,color=avg_sbi))+
scale_size(range = c(5,20))+
scale_alpha(range = c(0.5,1))+
geom_text(data=ubike3,aes(x=lng,y=lat,label=sna),color='red',vjust=c(-1,1,1,0),hjust=0,fontface=2,family = "STHeiti")+
theme(text=element_text(size=20))+scale_color_gradient(low="orange",high="yellow")
ggmap(m)+
geom_point(data=ubike3,aes(x=lng,y=lat,size=avg_wind,alpha=avg_hu,color=avg_sbi))+
scale_size(range = c(5,20))+
scale_alpha(range = c(0.5,1))+
geom_text(data=ubike3,aes(x=lng,y=lat,label=sna),color='red',vjust=c(-1,1,1,0),hjust=0,fontface=2,family = "STHeiti")+
theme(text=element_text(size=20))+scale_color_gradient(low="blue",high="yellow")
m<-get_map(location=c(lon=ubike3$lng[1], lat=ubike3$lat[1]))
help(get_map)
geocode('南港軟體園區',source = "goolge")
geocode('南港軟體園區',source = "google")
nankang=geocode('南港軟體園區',source = "google")
nan_map=get_map(nankang,zoom=14,maptype = 'roadmap',source = 'osm')
nan_map=get_map(location=c(lon=nankang$lon,lat=nankang$lat),zoom=14,maptype = 'roadmap',source = 'osm')
ggmap(nan_map)
nan_map=get_map(location=c(lon=nankang$lon,lat=nankang$lat),zoom=15,maptype = 'roadmap',source = 'osm')
ggmap(nan_map)
